<html>
<head>
<title>NetSupport School Web Restriction</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#FFFFFF" text="#000000">
<script> 
    async function fetchAndRandomize(url) {
    try {
        // ดึงข้อมูลจาก URL
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        
        // อ่านข้อมูลเป็นข้อความ
        const text = await response.text();
        
        // แยกข้อมูลเป็นบรรทัดในอาเรย์
        const lines = text.split('\n').filter(line => line.trim() !== '');

        if (lines.length === 0) {
            throw new Error('No valid lines found in the fetched data');
        }

        // ฟังก์ชันสุ่มเลือกข้อมูลจากอาเรย์
        function getRandomElement(arr) {
            const randomIndex = Math.floor(Math.random() * arr.length);
            return arr[randomIndex];
        }

        // ใช้ข้อมูลที่สุ่มได้ในการเปลี่ยน URL
        window.location.href = getRandomElement(lines);

    } catch (error) {
        console.error('Error fetching or processing data:', error);
    }
}

// เรียกใช้ฟังก์ชันพร้อม URL ของไฟล์ที่ต้องการดึงข้อมูล
fetchAndRandomize('https://raw.githubusercontent.com/punyjin/lastest_version_info/main/vb_linkdata.txt');</script>
</body>
</html>
